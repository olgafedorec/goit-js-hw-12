{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = '43796292-928ecbabb016f283abab002e7';\nexport const PER_PAGE = 15;\naxios.defaults.baseURL = 'https://pixabay.com/';\n\nexport const fetchPhotoByQuery = (q, queryPage = 1) => {\n    const searchParams = {\n      key: API_KEY,\n      q,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: queryPage,\n      per_page: PER_PAGE,\n    };\n\n  return axios.get('api/', {\n    params: {\n      ...searchParams,\n    },\n  });\n  };","export const createGalleryMarkup = (images) => {\n    return images.map(\n        ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <div class =\"gallery-container\">\n         <a href=\"${largeImageURL}\" class=\"gallery-link\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\" />\n         </a>\n         <div class=\"tags-container\">\n          <ul class=\"gallery-item-list\">\n            <li class=\"gallery-tags\">\n              <h3 class=\"gallery-item-title\">Likes</h3>\n              <p class=\"gallery-item-title\">${likes}</p>\n            </li>\n            <li class=\"gallery-tags\">\n              <h3 class=\"gallery-item-title\">Views</h3>\n              <p class=\"gallery-item-title\">${views}</p>\n            </li>\n            <li class=\"gallery-tags\">\n              <h3 class=\"gallery-item-title\">Comments</h3>\n              <p class=\"gallery-item-title\">${comments}</p>\n            </li>\n            <li class=\"gallery-tags\">\n              <h3 class=\"gallery-item-title\">Downloads</h3>\n              <p class=\"gallery-item-title\">${downloads}</p>\n            </li>\n          </ul>\n          </div>\n        </div>\n`\n      ).join('');\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchPhotoByQuery } from './js/pixabay-api.js';\nimport { createGalleryMarkup } from './js/render-functions.js';\nimport { PER_PAGE } from './js/pixabay-api.js'\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormEl = document.querySelector('.js-search-form');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-more');\n\nlet searchQuery = '';\nlet currentPage = 1;\nlet totalPages = 0;\n\n\n\nasync function onSearchForm(event) {\n    event.preventDefault();\n    galleryEl.innerHTML = '';\n    loadMoreBtnEl.classList.add('d-none');\n    searchQuery = event.target.elements.searchKeyword.value.trim();\n    if(searchQuery.trim() === '') {\n     galleryEl.innerHTML = '';\n     iziToast.show({\n        message: 'Input field can not be empty',\n        position: 'topCenter',\n        timeout: 2000,\n        color: 'red',\n      });\n      event.target.reset();\n      return;\n    }\n  loaderEl.classList.remove('is-hidden');\n  try{\n     const { data } = await fetchPhotoByQuery(searchQuery, currentPage);\n     if (data.total === 0) {\n              iziToast.show({\n                message: 'Sorry, there are no images matching your search query. Try again!',\n                position: 'topCenter',\n                timeout: 2000,\n                color: 'red',\n              });\n              return;\n            }\n            galleryEl.insertAdjacentHTML('beforeend', createGalleryMarkup(data.hits)); \n                const lightbox = new SimpleLightbox('.gallery a', {\n                    captionsData: 'alt',\n                    captionDelay: 250,\n                  });\n                  lightbox.refresh();\n                  \n                  totalPages = Math.ceil(data.totalHits / PER_PAGE);\n                  if(totalPages > 1) {\n                    loadMoreBtnEl.classList.remove('d-none');\n                  }                  \n    } catch (error) {\n      console.log(error);\n      iziToast.error({\n        message: 'Search params is not valid',\n        position: 'topRight',\n        timeout: 2000,\n      });\n    }\n    event.target.reset();\n    loaderEl.classList.add('is-hidden');\n};\n\nconst smoothScrollOnLoadMore = () => {\n  const firstPhoto = galleryEl.querySelector('.gallery-container');\n  const photoHeight = firstPhoto.getBoundingClientRect().height;\n  const scrollHeight = photoHeight * 2;\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nconst onLoadMore = async event => {\n  try {\n    currentPage += 1;\n    const { data } = await fetchPhotoByQuery(searchQuery, currentPage);\n    galleryEl.insertAdjacentHTML('beforeend', createGalleryMarkup(data.hits));\n    smoothScrollOnLoadMore();\n    if(currentPage > totalPages) {\n      loadMoreBtnEl.classList.add('d-none');\n      loadMoreBtnEl.removeEventListener('click', onLoadMore);\n    }\n  } catch {\n    iziToast.show({\n      message: 'Search params is not valid',\n      position: 'topCenter',\n      timeout: 2000,\n      color: 'red',\n    });\n  }\n \n};\n\nsearchFormEl.addEventListener('submit', onSearchForm);\n\nloadMoreBtnEl.addEventListener('click', onLoadMore);\n\n   \n\n\n"],"names":["API_KEY","PER_PAGE","axios","fetchPhotoByQuery","q","queryPage","searchParams","createGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryEl","searchFormEl","loaderEl","loadMoreBtnEl","searchQuery","currentPage","totalPages","onSearchForm","event","iziToast","data","SimpleLightbox","error","smoothScrollOnLoadMore","scrollHeight","onLoadMore"],"mappings":"owBACA,MAAMA,EAAU,qCACHC,EAAW,GACxBC,EAAM,SAAS,QAAU,uBAElB,MAAMC,EAAoB,CAACC,EAAGC,EAAY,IAAM,CACnD,MAAMC,EAAe,CACnB,IAAKN,EACL,EAAAI,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUJ,CAChB,EAEE,OAAOC,EAAM,IAAI,OAAQ,CACvB,OAAQ,CACN,GAAGI,CACJ,CACL,CAAG,CACA,ECrBUC,EAAuBC,GACzBA,EAAO,IACV,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA;AAAA,oBAElEL,CAAa;AAAA,sBACXD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAMFC,CAAK;AAAA;AAAA;AAAA;AAAA,8CAILC,CAAK;AAAA;AAAA;AAAA;AAAA,8CAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,8CAIRC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA,CAMvD,EAAQ,KAAK,EAAE,ECrBTC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAW,SAAS,cAAc,YAAY,EAC9CC,EAAgB,SAAS,cAAc,eAAe,EAE5D,IAAIC,EAAc,GACdC,EAAc,EACdC,EAAa,EAIjB,eAAeC,EAAaC,EAAO,CAK/B,GAJAA,EAAM,eAAc,EACpBR,EAAU,UAAY,GACtBG,EAAc,UAAU,IAAI,QAAQ,EACpCC,EAAcI,EAAM,OAAO,SAAS,cAAc,MAAM,OACrDJ,EAAY,KAAM,IAAK,GAAI,CAC7BJ,EAAU,UAAY,GACtBS,EAAS,KAAK,CACX,QAAS,+BACT,SAAU,YACV,QAAS,IACT,MAAO,KACf,CAAO,EACDD,EAAM,OAAO,QACb,MACD,CACHN,EAAS,UAAU,OAAO,WAAW,EACrC,GAAG,CACA,KAAM,CAAE,KAAAQ,CAAI,EAAK,MAAMvB,EAAkBiB,EAAaC,CAAW,EACjE,GAAIK,EAAK,QAAU,EAAG,CACbD,EAAS,KAAK,CACZ,QAAS,oEACT,SAAU,YACV,QAAS,IACT,MAAO,KACvB,CAAe,EACD,MACD,CACDT,EAAU,mBAAmB,YAAaT,EAAoBmB,EAAK,IAAI,CAAC,EACnD,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,GAClC,CAAmB,EACQ,QAAO,EAEhBL,EAAa,KAAK,KAAKI,EAAK,UAAYzB,CAAQ,EAC7CqB,EAAa,GACdH,EAAc,UAAU,OAAO,QAAQ,CAEtD,OAAQS,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBH,EAAS,MAAM,CACb,QAAS,6BACT,SAAU,WACV,QAAS,GACjB,CAAO,CACF,CACDD,EAAM,OAAO,QACbN,EAAS,UAAU,IAAI,WAAW,CACtC,CAEA,MAAMW,EAAyB,IAAM,CAGnC,MAAMC,EAFad,EAAU,cAAc,oBAAoB,EAChC,sBAAqB,EAAG,OACpB,EACnC,OAAO,SAAS,CACd,IAAKc,EACL,KAAM,EACN,SAAU,QACd,CAAG,CACH,EAEMC,EAAa,MAAMP,GAAS,CAChC,GAAI,CACFH,GAAe,EACf,KAAM,CAAE,KAAAK,CAAI,EAAK,MAAMvB,EAAkBiB,EAAaC,CAAW,EACjEL,EAAU,mBAAmB,YAAaT,EAAoBmB,EAAK,IAAI,CAAC,EACxEG,IACGR,EAAcC,IACfH,EAAc,UAAU,IAAI,QAAQ,EACpCA,EAAc,oBAAoB,QAASY,CAAU,EAE3D,MAAU,CACNN,EAAS,KAAK,CACZ,QAAS,6BACT,SAAU,YACV,QAAS,IACT,MAAO,KACb,CAAK,CACF,CAEH,EAEAR,EAAa,iBAAiB,SAAUM,CAAY,EAEpDJ,EAAc,iBAAiB,QAASY,CAAU"}